<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Document</title>
</head>
<body>
	<script type="text/javascript">
		/*
		 * 自定义事件：
		 * 		滚轮，wx.addEventListener(left)
		 * 定义：在某个条件成立的时候触发的事件就叫自定义事件（更多的是基于系统事件来进行判断的）。
		 * 
		 * addEvent(document,'上滚',function(){})

            onclick -> keydown + keyup

		            如何去模拟（映射一个事件）
		
		            在某个对象（“元素”）上定义一个自定义的属性，而这个属性为一个对象
		            这个对象专门用来存“元素”上绑定的事件名、事件函数
		            当触发了系统的事件（一定条件的成立）之后，循环事件名下的所有函数
		            依次调用。
		        订阅:存储事件名、事件绑定函数
		            {
		                'click':[function(){},function(){}],
		                'mouseup':[function(){}]
		            }
		
		            
		            {
		                'click':[function(){},function(){}],
		                'mouseup':[function(){}]
		            }
		
		           
		
		        
		        发布:某个条件成立的时候去触发对应的事件，调用一个或一些函数。
		            
            trigger()  触发器
            
		 */
		
		addEvent(document,'点击三次',function(){
			alert('点击');
		})
		addEvent(document,'点击三次',function(){
			alert('点击了');
		})
		console.log(document.event);
		
		//绑定器
		function addEvent(obj,eventName,fn){
			//如果是第一次绑定，那么建立一个新的对象，如果之前绑过了，就用之前那个对象
			obj.event = obj.event || {};
			//第一次绑定obj.event这个对象下创建一个key值为事件名，value值为空数组
			//第二次绑定就以第一次的数组进行添加
			obj.event[eventName] = obj.event[eventName] || [];
			//把对应的事件名下的数组push事件函数
			obj.event[eventName].push(fn);
		}
		
		//触发器
		function tigger(obj,eventName){
			//看看这个对象下有没有绑定事件名，没有就return
			if(!obj.event[eventName])return;
			//如果有循环事件名对应的数组，依次调用
			obj.event[eventName].forEach((e,i)=>{
				//改变this的指向
				e.call(obj);
			});
		}
		
		let num = 0;
		document.onclick = function(){
			num++;
			setTimeout(function(){
				num = 0;
			},2000);
			
			if(num == 3){
				//在某个条件成立的时候就触发
				tigger(this,'点击三次');
				num = 0;
			}
		}
	</script>
</body>
</html>